<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Collection - PokemonBTC</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/collection.css">
    <link rel="stylesheet" href="css/btc-theme.css">
    <script src="js/config.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <h1 class="logo">âš¡ PokemonBTC</h1>
            <nav>
                <ul class="nav-links">
                    <li><a href="dashboard.html" class="nav-link">Dashboard</a></li>
                    <li><a href="mint.html" class="nav-link">Mint</a></li>
                    <li><a href="battle.html" class="nav-link">Battle</a></li>
                    <li><a href="collection.html" class="nav-link">Collection</a></li>
                    <li><a href="#" class="nav-link" onclick="logout(event)">Logout</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="collection-container">
        <!-- Collection Header -->
        <div class="collection-header">
            <h1 style="color: var(--pokemon-red); margin-bottom: 0.5rem;">My Pokemon Collection</h1>
            <p style="color: #666; font-size: 1.1rem;">
                View and manage your Pokemon
            </p>
            <div id="collection-stats" class="collection-stats">
                <!-- Stats will be inserted here -->
            </div>
        </div>

        <!-- Collection Grid -->
        <div id="collection-grid" class="collection-grid">
            <!-- Pokemon cards will be inserted here -->
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 PokemonBTC. Battle on the blockchain!</p>
        </div>
    </footer>

    <!-- Authentication & Loading -->
    <script src="js/api-service.js"></script>
    <script src="js/auth-check.js"></script>
    <script src="js/loading.js"></script>

    <!-- Dynamic Script Loader Based on Config -->
    <script>
        // Load scripts based on APP_CONFIG.MODE
        const mode = APP_CONFIG.MODE;

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.body.appendChild(script);
            });
        }

        async function loadModeScripts() {
            // Common scripts
            await loadScript('js/pokemon-data.js');
            await loadScript('js/pokemon.js');
            await loadScript('js/storage.js'); // Always needed for balance management

            if (mode === 'blockchain') {
                // Blockchain mode
                console.log('ðŸ”— Loading BLOCKCHAIN mode for collection...');
                await loadScript('https://cdn.jsdelivr.net/npm/ethers@6/dist/ethers.umd.min.js');
                await loadScript('js/web3.js');
                console.log('âœ… Blockchain mode loaded for collection');
            } else {
                // Local storage mode
                console.log('ðŸ’¾ Loading LOCAL STORAGE mode for collection...');
                console.log('âœ… Local storage mode loaded for collection');
            }

            // Always load collection scripts
            await loadScript('js/collection.js');
        }

        // Load scripts when page loads
        loadModeScripts().catch(err => {
            console.error('Failed to load scripts:', err);
            alert('Failed to load application scripts. Please refresh the page.');
        });

        // Logout function
        function logout(event) {
            event.preventDefault();
            if (confirm('Are you sure you want to logout?')) {
                apiService.logout();
            }
        }
    </script>
</body>
</html>
